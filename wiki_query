-- Most Views
- Creating table for our data

CREATE EXTERNAL TABLE IF NOT EXISTS data (
	lang STRING,
	search STRING,
	visit INT,
  deli INT)
	ROW FORMAT DELIMITED
	FIELDS TERMINATED BY ' '
	LOCATION '/tmp/';
  
- Loading data in our table
  
LOAD DATA INPATH '/tmp/' INTO TABLE data;
  
- Query for getting page for maximum visits
  
CREATE TABLE IF NOT EXISTS total_en_pageviews
AS SELECT DISTINCT(search), SUM(visit) OVER (PARTITION BY search ORDER BY search) 
AS total_views FROM data 
WHERE search != 'Main_Page' AND search != 'Special:Search' AND search != '-';

SELECT * FROM total_en_pageviews
WHERE total_views > 10000
ORDER BY total_views DESC;
